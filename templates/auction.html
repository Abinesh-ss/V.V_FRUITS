{% extends "base.html" %}
{% block content %}
<h3>Auction Entry</h3>

<!-- Step 1: Ask Seller Name -->
<form method="POST" action="{{ url_for('add_auction') }}" class="row g-2 mb-4">
  <div class="col-md-3">
    <input class="form-control" name="seller_name" placeholder="Seller Name" required>
  </div>
  <div class="col-md-3">
    <input class="form-control" name="product" placeholder="Product" required>
  </div>
  <div class="col-md-2">
    <input step="0.01" class="form-control" name="weight" placeholder="Total Weight" required>
  </div>
  <div class="col-md-1">
    <input type="number" class="form-control" name="no_of_trays" placeholder="Trays" required>
  </div>
  <div class="col-md-2">
    <input step="0.01" class="form-control" name="price" placeholder="Price per unit" required>
  </div>
  <div class="col-md-3">
    <input class="form-control" name="buyer_name" placeholder="Buyer Name (optional)">
  </div>
  <div class="col-12 mt-2">
    <button class="btn btn-primary" type="submit">Add Auction Entry</button>
  </div>
</form>

<hr>

<!-- Show all auction entries -->
<table class="table table-sm table-striped">
  <thead>
    <tr>
      <th>Seller</th>
      <th>Product</th>
      <th>Weight</th>
      <th>Trays</th>
      <th>Quantity</th>
      <th>Price</th>
      <th>Buyer</th>
      <th>Bill Amount</th>
      <th>Time</th>
      <th>Action</th> <!-- ðŸ”¹ New -->
    </tr>
  </thead>
  <tbody>
    {% for row in auctions %}
      <tr>
        <td>{{ row.seller_name }}</td>
        <td>{{ row.product }}</td>
        <td>{{ row.weight }}</td>
        <td>{{ row.no_of_trays }}</td>
        <td>{{ row.quantity }}</td>
        <td>{{ row.price }}</td>
        <td>{{ row.buyer_name or '-' }}</td>
        <td>{{ row.bill_amount }}</td>
        <td>{{ row.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
        <td>
          <!-- ðŸ”¹ Button to generate seller bill -->
          <a href="{{ url_for('seller_bill', seller_name=row.seller_name) }}" class="btn btn-sm btn-success">
            Generate Bill
          </a>
        </td>
      </tr>
    {% else %}
      <tr><td colspan="10" class="text-center">No auction records</td></tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
